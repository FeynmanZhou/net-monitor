#!/bin/bash

# Usage:
#   export IMAGE=<string>               required    the fully qualified (with registry and commit tag) image "name" to be pushed
#   export REPORT_DIRECTORY=<string>    required    the full directory path to store the report.
#   export PROJECT_NAME=<string>        required    the project name.
trivy image -f sarif -o $PROJECT_NAME.sarif --exit-code 0 $IMAGE
cp -n $PROJECT_NAME.sarif $REPORT_DIRECTORY/$PROJECT_NAME.sarif